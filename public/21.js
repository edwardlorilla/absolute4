webpackJsonp([21],{1006:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,n=i(840),s=(a=n)&&a.__esModule?a:{default:a};e.default={beforeCreate:function(){axios.get("/api/supplies/mass-update")},components:{EditSupplies:s.default},data:function(){return{isDisabled:!1,option:{penColor:"rgb(0, 0, 0)",backgroundColor:"rgb(255,255,255)"},request_id:1,dialogVisible:!1,optionDivision:[],loadingDivision:!1,selectDivision:!1,isAddDivision:!1,division_name:"",division_supply:"",select:!1,cloneQuantity:0,addTable:{id:"",name:"",category_id:"",quantity:"",out_quantity:""},columns:[{id:"name",label:"Transactions Name"},{id:"category_id",label:"Category Name"},{id:"quantity",label:"Current Stock"},{id:"out_quantity",label:"Quantity"}],form:{supplies:[],division:"",request_date:"",request_year_code:""},loading:!1,options:[],labelPosition:"left",errors:[]}},methods:{addDivision:function(){var t=this;t.isDisabled=!0,axios.post("/api/divisions",{name:t.division_name,supply_division:t.division_supply}).then(function(e){t.$message({message:e.statusText,type:"success"}),t.isAddDivision=!1,t.isDisabled=!1,t.optionDivision.push({value:e.data.id,label:e.data.name}),t.form.division=e.data.id}).catch(function(e){e.response.data.errors&&e.response.data.message&&(t.$message({message:e.response.data.message,type:"error"}),t.isAddDivision=!1),t.isDisabled=!1})},onSubmitRequest:function(){var t=this,e=new Date,i=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();t.isDisabled=!0,t.errors=[],t.form.year=i,t.form.request_date=a+"/"+n+"/"+i,t.form.request_year_code=i,axios({method:t.$route.params.id?"PUT":"POST",url:"/api/"+(t.$route.params.id?t.$route.meta.url+"/"+t.$route.params.id:""+t.$route.meta.url),data:t.form}).then(function(e){t.$message({message:e.statusText,type:"success"}),t.isDisabled=!1,t.form={supplies:[],name:"",year:"",request_date:"",request_year_code:""},t.dialogVisible=!0,t.request_id=e.data.id,t.$root.store.dispatch("loadNotification")}).catch(function(e){e.response.data.errors&&e.response.data.message&&(t.errors=e.response.data.errors,t.$message({message:e.response.data.message,type:"error"})),t.isDisabled=!1})},onChangeOutQuantity:function(t,e){t>e?this.addTable.quantity-=t-e:this.addTable.quantity+=e-t},onChange:function(t){var e=this;e.select=!0,t?(e.addTable={id:t.id,name:t.name,description:t.description,quantity:t.quantity,out_quantity:0},e.cloneQuantity=t.quantity,e.select=!1):(e.addTable={id:"",name:"",category_id:"",quantity:"",out_quantity:""},e.cloneQuantity=0,e.select=!1)},addColumn:function(){var t="Please input the",e=this;e.addTable.id&&e.addTable.name&&e.addTable.out_quantity?axios.get("/api/supplies/disabled/"+e.addTable.id).then(function(t){e.form.supplies.unshift(_.clone(e.addTable)),e.options=[],e.addTable={id:"",name:"",quantity:"",out_quantity:""}}):(e.addTable.id&&(t+=" ID |"),e.addTable.name&&(t+=" Name |"),e.$message({message:t,type:"warning"}))},onSearchDivision:_.debounce(function(t,e){axios.get("/api/search/divisions?search="+t).then(function(t){e.loadingDivision=!1,e.optionDivision=t.data.map(function(t){return{value:t.id,label:t.name}})}).catch(function(){e.loadingDivision=!1})},350),onSearch:_.debounce(function(t,e){e.loading=!0,axios.get("/api/search/supplies?search="+t+"&type=1").then(function(t){e.loading=!1,e.options=t.data.map(function(t){return{value:t,label:t.name}})}).catch(function(){e.loading=!1})},350),searchDivision:function(t){var e=this;""!==t?(e.loadingDivision=!0,e.onSearchDivision(t,e)):(e.loadingDivision=!1,e.optionDivision=[])},search_:function(t){var e=this;""!==t?(e.loading=!0,e.onSearch(t,e)):(e.loading=!1,e.option=[])}}}},1007:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"card"},[i("div",{staticClass:"card-header"},[t._v("\n        Request Items\n    ")]),t._v(" "),i("div",{staticClass:"card-body"},[i("div",[i("el-form",{ref:"form",attrs:{"label-position":t.labelPosition,size:"mini",model:t.form},nativeOn:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-lg-5"},[i("div",{staticClass:"form-group"},[t.isAddDivision?i("div",[i("div",{staticClass:"input-group input-group-sm"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.division_name,expression:"division_name"}],staticClass:"form-control",attrs:{placeholder:"Division Name",type:"text"},domProps:{value:t.division_name},on:{input:function(e){e.target.composing||(t.division_name=e.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.division_supply,expression:"division_supply"}],staticClass:"form-control",attrs:{placeholder:"Supply Division Name",type:"text"},domProps:{value:t.division_supply},on:{input:function(e){e.target.composing||(t.division_supply=e.target.value)}}}),t._v(" "),i("span",{staticClass:"input-group-append"},[i("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:t.addDivision}},[t._v("Create Division")]),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(e){t.isAddDivision=!1}}},[t._v("Cancel")])])])]):i("div",[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm"},[i("label",{staticClass:"el-form-item__label",attrs:{for:"division"}},[t._v("Division")])]),t._v(" "),i("div",{staticClass:"col-sm text-right"},[t.isAddDivision?t._e():i("button",{staticClass:"btn btn-sm btn-link",attrs:{type:"button"},on:{click:function(e){t.isAddDivision=!t.isAddDivision}}},[t._v("Add Division\n                                        ")])])]),t._v(" "),i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.selectDivision,remote:"",clearable:"",filterable:"",placeholder:"Please enter a keyword","remote-method":t.searchDivision,"default-first-option":"",loading:t.loadingDivision},model:{value:t.form.division,callback:function(e){t.$set(t.form,"division",e)},expression:"form.division"}},t._l(t.optionDivision,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],1)])]),t._v(" "),i("div",{staticClass:"col-sm-12"},[i("h3",[t._v("Add Items")]),t._v(" "),i("table",{staticClass:"table table-bordered"},[i("thead",[i("tr",[i("th",[t._v("Product Name")]),t._v(" "),i("th",[t._v("Current Stock")]),t._v(" "),i("th",[t._v("Quantity")]),t._v(" "),i("th",[t._v("Action")])])]),t._v(" "),i("tbody",[i("tr",[i("td",[i("el-select",{attrs:{disabled:t.select,remote:"",clearable:"",filterable:"",placeholder:"Please enter a keyword","remote-method":t.search_,loading:t.loading},on:{change:t.onChange},model:{value:t.addTable.name,callback:function(e){t.$set(t.addTable,"name",e)},expression:"addTable.name"}},t._l(t.options,function(t,e){return i("el-option",{key:e,attrs:{"value-key":t.value.id,label:t.label,value:t.value}})}))],1),t._v(" "),i("td",[i("el-input",{attrs:{disabled:!0,type:"number",min:"0",max:"addTable.quantity",placeholder:"Current Quantity"},model:{value:t.addTable.quantity,callback:function(e){t.$set(t.addTable,"quantity",e)},expression:"addTable.quantity"}})],1),t._v(" "),i("td",[i("el-input-number",{attrs:{min:0,max:t.cloneQuantity},on:{change:t.onChangeOutQuantity},model:{value:t.addTable.out_quantity,callback:function(e){t.$set(t.addTable,"out_quantity",e)},expression:"addTable.out_quantity"}})],1),t._v(" "),i("td",[i("el-button",{attrs:{type:"primary",disabled:0===t.addTable.out_quantity},on:{click:t.addColumn}},[t._v("Add\n                                    ")])],1)]),t._v(" "),t._l(t.form.supplies,function(t,e){return i("edit-supplies",{key:e,attrs:{max:t.cloneQuantity,item:t}})})],2)])])]),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",disabled:0===t.form.supplies.length,loading:t.isDisabled},on:{click:t.onSubmitRequest}},[t._v(t._s(t.$route.meta.type)+"\n                    ")]),t._v(" "),i("el-button",{attrs:{loading:t.isDisabled},on:{click:function(e){t.$router.push("/"+t.$route.meta.url)}}},[t._v("Back")])],1)],1)],1)])])},staticRenderFns:[]}},462:function(t,e,i){var a=i(36)(i(1006),i(1007),!1,null,null,null);t.exports=a.exports},840:function(t,e,i){var a=i(36)(i(841),i(842),!1,null,null,null);t.exports=a.exports},841:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["item","max"],data:function(){return{edit_:!1}},methods:{onChangeOutQuantity:function(t,e){t>e?this.item.quantity-=t-e:this.item.quantity+=e-t},onEdit:function(){this.edit_=!this.edit_}}}},842:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("td",[t.edit_?i("el-input",{attrs:{placeholder:"Product Name"},model:{value:t.item.name,callback:function(e){t.$set(t.item,"name",e)},expression:"item.name"}}):i("label",[t._v(t._s(t.item.name))])],1),t._v(" "),i("td",[t.edit_?i("el-input",{attrs:{disabled:!0,type:"number",min:"0",max:"addTable.quantity",placeholder:"Current Quantity"},model:{value:t.item.quantity,callback:function(e){t.$set(t.item,"quantity",e)},expression:"item.quantity"}}):i("label",[t._v(t._s(t.item.quantity))])],1),t._v(" "),i("td",[t.edit_?i("el-input-number",{attrs:{min:0,max:t.max},on:{change:t.onChangeOutQuantity},model:{value:t.item.out_quantity,callback:function(e){t.$set(t.item,"out_quantity",e)},expression:"item.out_quantity"}}):i("label",[t._v(t._s(t.item.out_quantity))])],1),t._v(" "),i("td",[i("el-button",{attrs:{type:"primary"},on:{click:t.onEdit}},[t._v(t._s(t.edit_?"Done":"Edit"))])],1)])},staticRenderFns:[]}}});