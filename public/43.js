webpackJsonp([43],{454:function(e,t,a){var r=a(36)(a(927),a(928),!1,function(e){a(925)},null,null);e.exports=r.exports},925:function(e,t,a){var r=a(926);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(96)("4c3be6ad",r,!0,{})},926:function(e,t,a){(e.exports=a(30)(!1)).push([e.i,".el-table .warning-row{background:oldlace}.el-table .success-row{background:#f0f8ff}.el-input-group__prepend{background-color:#fff}",""])},927:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],r=!0,s=!1,n=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){s=!0,n=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw n}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(e,t,a){axios.get(""+e,{params:t}).then(function(e){a(null,{data:e.data,page:t})}).catch(function(e){e&&a(e,e.response)})};t.default={data:function(){return{errors:[],date_delivered:"",po_number:"",pr_number:"",expiry_date:"",quantity_per:0,product:{},quantity:0,unit_cost:0,units:[],dispensing_units:[],isAddDispensingUnit:!1,isAddSource:!1,isAddUnit:!1,unit_id:"",unit_name:"",dispensing_unit_id:"",source_select:"",sources:[],source_name:"",num1:1,filters:[{value:"",search_prop:"id"},{value:"",search_prop:"id"},{value:"",search_prop:"id"}],dialogMessage:{title:"",message:""},dialogVisible:!1,actionCol:{label:"Action",props:{align:"center"}},isDisabled:!1,query:{page:1,column:"id",direction:"desc",per_page:15,search_column:"all",search_operator:"like",search_input:""},operators:{equal:"=",not_equal:"<>",less_than:"<",greater_than:">",less_than_or_equal_to:"<=",greater_than_or_equal_to:">=",in:"IN",like:"LIKE"},columns:[{}],sortKey:"",sortOrders:{},data:[],meta:{},links:{first:null,last:null,next:null,prev:null},error:null,filterKey:"",loading:!1,_numberLoad:0,users:[],tableProps:{rowClassName:function(e){var t=e.row;e.rowIndex;return"OUT"==t.type?"warning-row":"success-row"}}}},computed:{unitCost:function(){return this.quantity&&parseFloat(this.quantity_per)>0?parseFloat(this.quantity)*parseFloat(this.quantity_per):0},totalCost:function(){var e=this;return e.quantity&&parseFloat(e.quantity_per)&&e.product.unit_cost>0?parseFloat(e.quantity)*parseFloat(e.quantity_per)*parseFloat(e.product.unit_cost):0},nextPage:function(){if(this.meta&&this.meta.current_page!==this.meta.last_page){return this.meta.current_page+1}},prevPage:function(){if(this.meta&&1!==this.meta.current_page){return this.meta.current_page-1}},paginatonCount:function(){if(this.meta){var e=this.meta;return"Displaying "+e.current_page+" of "+e.last_page+" rows"}}},beforeRouteEnter:function(e,t,a){e.params.id?s("/api/"+e.meta.url+"/"+e.params.id,e.query,function(e,t){a(function(a){return a.setData(e,t)})}):a()},beforeRouteUpdate:function(e,t,a){var r=this;e.params.id?s("/api/"+e.meta.url+"/"+e.params.id,e.query,function(e,t){r.setData(e,t),a()}):a()},methods:{unit_m:function(e){return axios.post("/api/units",e)},addUnit:function(){var e=this;e.isDisabled=!0,e.errors=[],e.unit_m({name:e.unit_name}).then(function(t){e.$message({message:t.statusText,type:"success"}),e.units=[],e.units.push({value:t.data,label:t.data.name}),e.unit_id=t.data.id,e.isDisabled=!1,e.isAddUnit=!1}).catch(function(t){t.response.data.errors&&t.response.data.message&&e.$message({message:t.response.data.message,type:"error"}),e.isDisabled=!1})},search_unit:function(e){var t=this;""!==e?(t.loading=!0,t.onSearchUnit(e,t)):(t.loading=!1,t.units=[])},search_dispensing_unit:function(e){var t=this;""!==e?(t.loading=!0,t.onSearchDispensingUnit(e,t)):(t.loading=!1,t.dispensing_units=[])},getUnit:function(e){return axios.get("/api/search/units?search="+e)},onSearchDispensingUnit:_.debounce(function(e,t){t.getUnit(e).then(function(e){t.loading=!1,t.dispensing_units=e.data.map(function(e){return{value:e,label:e.name}})}).catch(function(){t.loading=!1})},350),onSearchUnit:_.debounce(function(e,t){t.getUnit(e).then(function(e){t.loading=!1,t.units=e.data.map(function(e){return{value:e,label:e.name}})}).catch(function(){t.loading=!1})},350),handleSidebar:function(){this.isAddSource=!this.isAddSource,this.$root.store.dispatch("handleSideBar")},addSource:function(){var e=this;e.isDisabled=!0,axios.post("/api/sources",{name:e.source_name}).then(function(t){return e.$message({message:t.statusText,type:"success"}),e.isAddSource=!1,e.sources.push({value:t.data,label:t.data.name}),e.isDisabled=!1,t.data.id}).then(function(t){e.source_select=t}).catch(function(t){t.response.data.errors&&t.response.data.message&&e.$message({message:t.response.data.message,type:"error"}),e.isAddDivision=!1,e.isDisabled=!1}),e.$root.store.dispatch("handleSideBar")},search_source:function(e){var t=this;""!==e?(t.loading=!0,t.onSearchSource(e,t)):(t.loading=!1,t.sources=[])},onSearchSource:_.debounce(function(e,t){axios.get("/api/search/sources?search="+e).then(function(e){t.loading=!1,t.sources=e.data.map(function(e){return{value:e,label:e.name}})}).catch(function(){t.loading=!1})},350),clearTypeHandleChange:function(){vm.filters[2].value=""},onSubmit:function(){var e=this;e.errors=[],e.loading=!0;var t=new FormData(e.$refs.form),a={},s=!0,n=!1,i=void 0;try{for(var o,l=t.entries()[Symbol.iterator]();!(s=(o=l.next()).done);s=!0){var u=r(o.value,2),c=u[0],d=u[1];a[c]=d}}catch(e){n=!0,i=e}finally{try{!s&&l.return&&l.return()}finally{if(n)throw i}}e.$route.params.id&&(a.id=e.$route.params.id),a.quantity_per=e.quantity_per,a.quantity=e.quantity*e.quantity_per,a.source_select=e.source_select,axios.post("/api/products/"+e.$route.params.id+"/check-item",a).then(function(t){e.$message({message:t.statusText,type:"success"}),t.data.type=0===t.data.type?"OUT":"IN",e.data.unshift(t.data),e.loading=!1}).catch(function(t){t.response.data.errors&&t.response.data.message?(e.errors=t.response.data.errors,e.$message({message:t.response.data.message,type:"error"}),e.$root.store.dispatch("loadNotification")):t.response&&e.$message({message:t.response.statusText,type:"error"}),e.loading=!1})},sortBy:function(e){this.sortKey=e,this.sortOrders[e]=-1*this.sortOrders[e]},loadData:_.debounce(function(e){var t=this;t.loading=!0;var a=_.clone(t.$route.query);"sort"===e.type&&(a.column=e.sort.prop,a.direction="ascending"==e.sort.order?"asc":"desc"),"init"!=e.type?("page"===e.type&&(a.page=e.page,a.per_page=e.pageSize),"filter"!==e.type||_.isEmpty(t.filters[0].value)?"filter"!==e.type||_.isEmpty(t.filters[1].value)?"filter"!==e.type||_.isEmpty(t.filters[2].value)?(delete a.user_id,delete a.search_input):a.type=t.filters[2].value.toString():a.user_id=t.filters[1].value.toString():(a.search_column=t.query.search_column,a.search_operator=t.query.search_operator,a.search_input=t.filters[0].value),_.isEmpty(t.filters[2].value)&&delete a.type,t.$router.push({path:""+t.$route.path,query:a},function(){t.loading=!1,""==a.search_input&&(delete a.search_input,t.filters[1].value="")},function(){t.loading=!1})):t.loading=!1},500),setData:function(e,t){var a=this;if(e)404===e.response.status&&a.$router.push({name:"error.not-found",params:{0:"/"}}),a.error=e.toString();else{a.data=_.map(t.data.model.data,function(e){return e.type=0==e.type?"OUT":"IN",e});var r=_.map(a.data,function(e){return e.user});a.product=t.data.product,a.users=_.compact(_.uniqBy(r,"id")),a.links.first_page_url=t.data.model.first_page_url,a.links.last_page_url=t.data.model.last_page_url,a.links.prev_page_url=t.data.model.prev_page_url,a.links.next_page_url=t.data.model.next_page_url,a.meta.current_page=t.data.model.current_page,a.meta.from=t.data.model.from,a.meta.last_page=t.data.model.last_page,a.query.per_page=_.parseInt(t.data.model.per_page),a.meta.to=t.data.model.to,a.meta.total=t.data.model.total,a.columns=t.data.columns,t.page.search_input&&(a.filters[0].value=t.page.search_input),a.filters[0].search_prop=a.search_column}}}}},928:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header"},[e._v("\n                        Medicine Information\n                    ")]),e._v(" "),a("div",{staticClass:"card-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("strong",[e._v("Generic Name:")]),e._v(" "+e._s(e.product.medicine_id?e.product.medicine.name.toUpperCase():"")+"\n                            ")]),e._v(" "),a("div",{staticClass:"col"},[a("strong",[e._v("Unit Cost:")]),e._v(" "+e._s(e.product.unit_cost)+"\n                            ")])]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("strong",[e._v("Unit:")]),e._v(" "+e._s(e.product.category_id?e.product.category.name:"")+"\n                            ")]),e._v(" "),a("div",{staticClass:"col"},[a("label",{attrs:{for:"total_quantity"}},[e._v("Total Quantity: ")]),e._v("\n                                "+e._s(e.unitCost)+"\n                            ")])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("label",{attrs:{for:"total_cost"}},[e._v("Total Cost: ")]),e._v("\n                                "+e._s(e.totalCost)+"\n                            ")])])]),e._v(" "),a("div",{staticClass:"card-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"po_number"}},[e._v("PO Number")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.po_number,expression:"po_number"}],staticClass:"form-control form-control-sm",class:e.errors.po_number?"is-invalid":"",attrs:{required:"",type:"text",tabindex:"1",id:"po_number",name:"po_number",placeholder:"po_number"},domProps:{value:e.po_number},on:{input:function(t){t.target.composing||(e.po_number=t.target.value)}}}),e._v(" "),e._l(e.errors.po_number,function(t){return e.errors.po_number?a("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[a("strong",[e._v("PO number has already taken")])]):e._e()})],2),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"package"}},[e._v("Quantity per "+e._s(e.product.package_id?e.product.package.name:"box")+" / Bundle")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.quantity_per,expression:"quantity_per"}],staticClass:"form-control form-control-sm",attrs:{required:"",type:"number",min:1,id:"package",tabindex:"2",name:"quantity",placeholder:"Quantity per "+(e.product.package_id?e.product.package.name:"box")},domProps:{value:e.quantity_per},on:{input:function(t){t.target.composing||(e.quantity_per=t.target.value)}}})]),e._v(" "),a("div",{staticClass:"el-form-item",class:e.errors.source_select?"is-error is-required":""},[a("div",{staticClass:"row"},[e._m(0),e._v(" "),a("div",{staticClass:"col-sm text-right"},[e.isAddSource?e._e():a("button",{staticClass:"btn btn-sm btn-link",attrs:{type:"button"},on:{click:e.handleSidebar}},[e._v("Add Source\n                                            ")])])]),e._v(" "),a("div",{staticClass:"el-form-item__content"},[e.isAddSource?a("div",[a("div",{staticClass:"input-group input-group-sm"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.source_name,expression:"source_name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.source_name},on:{input:function(t){t.target.composing||(e.source_name=t.target.value)}}}),e._v(" "),a("span",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:e.addSource}},[e._v("Create Source")]),e._v(" "),a("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(t){e.isAddSource=!1,e.$root.store.dispatch("handleSideBar")}}},[e._v("Cancel")])])])]):a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",disabled:e.isDisabled,filterable:"",tabindex:"3",remote:"",required:"",placeholder:"Enter Source of Fund Name","remote-method":e.search_source,loading:e.loading},model:{value:e.source_select,callback:function(t){e.source_select=t},expression:"source_select"}},e._l(e.sources,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value.id}})})),e._v(" "),e._l(e.errors.source_select,function(t){return e.errors.source_select?a("div",{staticClass:"el-form-item__error"},[e._v("\n                                            "+e._s(t)+"\n                                        ")]):e._e()})],2)])]),e._v(" "),a("div",{staticClass:"col"},[a("div",{staticClass:"form-group has-feedback"},[a("label",{attrs:{for:"date_delivered"}},[e._v("Date Delivered")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.date_delivered,expression:"date_delivered"}],staticClass:"form-control form-control-sm",class:e.errors.date_delivered?"is-invalid":"",attrs:{required:"",type:"date",tabindex:"6",id:"date_delivered",name:"date_delivered",placeholder:"Date Delivered"},domProps:{value:e.date_delivered},on:{input:function(t){t.target.composing||(e.date_delivered=t.target.value)}}}),e._v(" "),e._l(e.errors.date_delivered,function(t){return e.errors.date_delivered?a("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[a("strong",[e._v(e._s(t))])]):e._e()})],2),e._v(" "),a("div",{staticClass:"form-group has-feedback"},[a("label",{attrs:{for:"quantity"}},[e._v("Quantity Delivered")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.quantity,expression:"quantity"}],staticClass:"form-control form-control-sm",class:e.errors.quantity?"is-invalid":"",attrs:{required:"",type:"number",min:"1",id:"quantity",tabindex:"7",name:"quantity",placeholder:"Quantity"},domProps:{value:e.quantity},on:{input:function(t){t.target.composing||(e.quantity=t.target.value)}}}),e._v(" "),e._l(e.errors.quantity,function(t){return e.errors.quantity?a("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[a("strong",[e._v(e._s(t))])]):e._e()})],2),e._v(" "),a("div",{staticClass:"form-group has-feedback"},[a("label",{attrs:{for:"expiry_date"}},[e._v("Expiry Date")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.expiry_date,expression:"expiry_date"}],staticClass:"form-control form-control-sm",class:e.errors.expiry_date?"is-invalid":"",attrs:{type:"date",id:"expiry_date",tabindex:"9",name:"expiry_date",placeholder:"expiry_date"},domProps:{value:e.expiry_date},on:{input:function(t){t.target.composing||(e.expiry_date=t.target.value)}}}),e._v(" "),e._l(e.errors.expiry_date,function(t){return e.errors.expiry_date?a("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[a("strong",[e._v(e._s(t))])]):e._e()})],2)])])]),e._v(" "),a("div",{staticClass:"card-footer"},[a("button",{staticClass:"btn btn-primary mb-2",attrs:{type:"submit",disabled:!(e.date_delivered&&e.expiry_date&&e.po_number&&e.quantity&&e.quantity_per&&e.source_select)||e.loading}},[e._v("Check in")])])])])])]),e._v(" "),e.data?a("div",{staticClass:"dv"},[a("div",{staticClass:"dv-header"},[a("div",{staticClass:"dv-header-columns"},[a("span",{staticClass:"dv-header-pre"},[e._v("Search: ")]),e._v(" "),a("el-select",{attrs:{placeholder:"Select"},model:{value:e.query.search_column,callback:function(t){e.$set(e.query,"search_column",t)},expression:"query.search_column"}},[a("el-option",{attrs:{label:"All",value:"all"}}),e._v(" "),e._l(e.columns,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})],2)],1),e._v(" "),a("div",{staticClass:"dv-header-operators"},[a("el-select",{attrs:{placeholder:"Select"},model:{value:e.query.search_operator,callback:function(t){e.$set(e.query,"search_operator",t)},expression:"query.search_operator"}},e._l(e.operators,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),a("div",{staticClass:"dv-header-search"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-4"},[a("el-input",{attrs:{placeholder:"Search"},on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.loadData(t):null}},model:{value:e.filters[0].value,callback:function(t){e.$set(e.filters[0],"value",t)},expression:"filters[0].value"}})],1),e._v(" "),a("div",{staticClass:"col-lg-4"},[a("el-select",{attrs:{clearable:"",placeholder:"Select Users",multiple:"multiple"},model:{value:e.filters[1].value,callback:function(t){e.$set(e.filters[1],"value",t)},expression:"filters[1].value"}},e._l(e.users,function(e,t,r){return a("el-option",{key:r,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("div",{staticClass:"col-lg-4"},[a("el-select",{attrs:{clearable:"",placeholder:"Select Type"},on:{clear:e.clearTypeHandleChange},model:{value:e.filters[2].value,callback:function(t){e.$set(e.filters[2],"value",t)},expression:"filters[2].value"}},[a("el-option",{attrs:{label:"IN",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"OUT",value:"0"}})],1)],1)])])]),e._v(" "),e.nextPage||e.prevPage||!e.nextPage||!e.prevPage||e.meta?a("data-tables-server",{attrs:{data:e.data,"action-col":e.actionCol,total:e.meta.total,filters:e.filters,"pagination-props":{background:!0,pageSize:e.query.per_page,pageSizes:[e.query.per_page,10,20,30]},"page-size":e.query.per_page,"current-page":e.meta.current_page,"table-props":e.tableProps,loading:e.loading},on:{"query-change":e.loadData}},e._l(e.columns,function(e){return a("el-table-column",{key:e.id,attrs:{prop:e.id,label:e.name,sortable:"custom"}})})):e._e()],1):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"col-sm"},[t("label",{attrs:{for:"source"}},[this._v("Source")])])}]}}});