webpackJsonp([22],{795:function(e,t,i){var a=i(36)(i(980),i(984),!1,null,null,null);e.exports=a.exports},980:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=i(981),s=(a=n)&&a.__esModule?a:{default:a};t.default={beforeCreate:function(){axios.get("/api/supplies/mass-update")},beforeRouteEnter:function(e,t,i){e.params.id?axios.get("/api/pending/"+e.params.id).then(function(e){i(function(t){return t.setData(e.data)})}):i()},beforeRouteUpdate:function(e,t,i){var a=this;e.params.id?axios.get("/api/pending/"+e.params.id).then(function(e){a.setData(e.data),i()}):i()},components:{EditSupplies:s.default},data:function(){return{isDisabled:!1,option:{penColor:"rgb(0, 0, 0)",backgroundColor:"rgb(255,255,255)"},request_id:1,dialogVisible:!1,optionDivision:[],optionSupplier:[],loadingSupplier:!1,loadingDivision:!1,selectDivision:!1,selectSupplier:!1,isAddDivision:!1,isAddSupplier:!1,division_name:"",division_supply:"",select:!1,cloneQuantity:0,addTable:{id:"",name:"",category_id:"",package_id:"",quantity:"",out_quantity:""},columns:[{id:"name",label:"Transactions Name"},{id:"category_id",label:"Category Name"},{id:"package_id",label:"Unit"},{id:"quantity",label:"Current Stock"},{id:"out_quantity",label:"Quantity"}],form:{supplies:[],division:"",supplier:"",request_date:"",request_year_code:"",po_number:""},loading:!1,options:[],labelPosition:"left",errors:[],supplier:"",supplier_name:"",supplier_address:""}},methods:{setData:function(e){var t=this;t.form.supplies=[],t.form.user_id=e.data.user_id,t.$root.store.dispatch("loadingChange",!0),axios.get("/api/division/"+e.data.data.division).then(function(i){t.optionDivision.push({label:i.data.name,value:i.data.id}),t.form.division=e.data.data.division}),_.map(e.data.data.supplies,function(i){axios.get("/api/supplies/"+i.id).then(function(a){if(t.form.supplies.push({id:a.data.supply.id,name:i.name,quantity:a.data.supply.quantity,out_quantity:a.data.supply.quantity<i.out_quantity?a.data.supply.quantity:i.out_quantity}),e.data.data.supplies.length)return""}).then(function(e){t.$root.store.dispatch("loadingChange",!1)})})},addDivision:function(){var e=this;e.isDisabled=!0,axios.post("/api/divisions",{name:e.division_name,supply_division:e.division_supply}).then(function(t){e.$message({message:t.statusText,type:"success"}),e.isAddDivision=!1,e.isDisabled=!1,e.optionDivision.push({value:t.data.id,label:t.data.name}),e.form.division=t.data.id}).catch(function(t){t.response.data.errors&&t.response.data.message&&(e.$message({message:t.response.data.message,type:"error"}),e.isAddDivision=!1),e.isDisabled=!1})},addSupplier:function(){var e=this;e.isDisabled=!0,axios.post("/api/suppliers",{name:e.supplier_name,address:e.supplier_address}).then(function(t){e.$message({message:t.statusText,type:"success"}),e.isAddSupplier=!1,e.isDisabled=!1,e.optionSupplier.push({value:t.data.id,label:t.data.name}),e.form.supplier=t.data.id}).catch(function(t){t.response.data.errors&&t.response.data.message&&(e.$message({message:t.response.data.message,type:"error"}),e.isAddSupplier=!1),e.isDisabled=!1})},onSubmitRequest:function(){var e=this,t=new Date,i=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();e.isDisabled=!0,e.errors=[],e.form.year=i,e.form.request_date=a+"/"+n+"/"+i,e.form.request_year_code=i,axios({method:"POST",url:"/api/pending/supply/approved/"+e.$route.params.id+"?type="+e.$route.meta.onSubmitType,data:e.form}).then(function(t){e.$message({message:t.statusText,type:"success"}),e.isDisabled=!1,e.form={supplies:[],name:"",year:"",request_date:"",request_year_code:"",po_number:""},e.dialogVisible=!0,e.request_id=t.data.id,e.$root.store.dispatch("loadNotification"),e.$router.push({name:"pending-request.view"})}).catch(function(t){t.response.data.errors&&t.response.data.message&&(e.errors=t.response.data.errors,e.$message({message:t.response.data.message,type:"error"})),e.isDisabled=!1})},onSubmitRejectRequest:function(){var e=this,t=new Date,i=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();e.isDisabled=!0,e.errors=[],e.form.year=i,e.form.request_date=a+"/"+n+"/"+i,e.form.request_year_code=i,e.$confirm("Are You sure?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){axios({method:"POST",url:"/api/pending/supply/rejected/"+e.$route.params.id+"?type="+e.$route.meta.onSubmitType,data:e.form}).then(function(t){e.$message({message:t.statusText,type:"success"}),e.isDisabled=!1,e.form={supplies:[],name:"",year:"",request_date:"",request_year_code:""},e.dialogVisible=!0,e.request_id=t.data.id;var i=e.$root.store.state.notifications.data,a=_.findIndex(i,["id",e.$route.params.id]);i.splice(a,1),e.$router.push({name:"pending-request.view"})}).catch(function(t){console.log(t),t&&(e.errors=t.response.data.errors,e.$message({message:t.response.data.message,type:"error"})),e.isDisabled=!1})}).catch(function(e){this.$message({type:"info",message:"Delete canceled"})})},onChangeOutQuantity:function(e,t){e>t?this.addTable.quantity-=e-t:this.addTable.quantity+=t-e},onChange:function(e){var t=this;t.select=!0,e?(t.addTable={id:e.id,name:e.name,description:e.description,quantity:e.quantity,out_quantity:0},t.cloneQuantity=e.quantity,t.select=!1):(t.addTable={id:"",name:"",category_id:"",package_id:"",quantity:"",out_quantity:""},t.cloneQuantity=0,t.select=!1)},addColumn:function(){var e="Please input the",t=this;t.addTable.id&&t.addTable.name&&t.addTable.out_quantity?axios.get("/api/supplies/disabled/"+t.addTable.id).then(function(e){t.form.supplies.unshift(_.clone(t.addTable)),t.options=[],t.addTable={id:"",name:"",quantity:"",out_quantity:""}}):(t.addTable.id&&(e+=" ID |"),t.addTable.name&&(e+=" Name |"),t.$message({message:e,type:"warning"}))},onSearchDivision:_.debounce(function(e,t){axios.get("/api/search/divisions?search="+e).then(function(e){t.loadingDivision=!1,t.optionDivision=e.data.map(function(e){return{value:e.id,label:e.name}})}).catch(function(){t.loadingDivision=!1})},350),onSearchSupplier:_.debounce(function(e,t){axios.get("/api/search/suppliers?search="+e).then(function(e){t.loadingSupplier=!1,t.optionSupplier=e.data.map(function(e){return{value:e.id,label:e.name}})}).catch(function(){t.loadingSupplier=!1})},350),onSearch:_.debounce(function(e,t){t.loading=!0,axios.get("/api/search/supplies?search="+e).then(function(e){t.loading=!1,t.options=e.data.map(function(e){return{value:e,label:e.name}})}).catch(function(){t.loading=!1})},350),searchDivision:function(e){var t=this;""!==e?(t.loadingDivision=!0,t.onSearchDivision(e,t)):(t.loadingDivision=!1,t.optionDivision=[])},searchSupplier:function(e){var t=this;""!==e?(t.loadingSupplier=!0,t.onSearchSupplier(e,t)):(t.loadingSupplier=!1,t.optionSupplier=[])},search_:function(e){var t=this;""!==e?(t.loading=!0,t.onSearch(e,t)):(t.loading=!1,t.option=[])}}}},981:function(e,t,i){var a=i(36)(i(982),i(983),!1,null,null,null);e.exports=a.exports},982:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["item","max"],data:function(){return{edit_:!1}},methods:{onChangeOutQuantity:function(e,t){e>t?this.item.quantity-=e-t:this.item.quantity+=t-e},onEdit:function(){this.edit_=!this.edit_}}}},983:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("tr",[i("td",[e.edit_?i("el-input",{attrs:{placeholder:"Product Name"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}}):i("label",[e._v(e._s(e.item.name))])],1),e._v(" "),i("td",[e.edit_?i("el-input",{attrs:{disabled:!0,type:"number",min:"0",max:"addTable.quantity",placeholder:"Current Quantity"},model:{value:e.item.quantity,callback:function(t){e.$set(e.item,"quantity",t)},expression:"item.quantity"}}):i("label",[e._v(e._s(e.item.quantity))])],1),e._v(" "),i("td",[e.edit_?i("el-input-number",{attrs:{min:0,max:e.max},on:{change:e.onChangeOutQuantity},model:{value:e.item.out_quantity,callback:function(t){e.$set(e.item,"out_quantity",t)},expression:"item.out_quantity"}}):i("label",[e._v(e._s(e.item.out_quantity))])],1),e._v(" "),i("td",[i("el-button",{attrs:{type:"primary"},on:{click:e.onEdit}},[e._v(e._s(e.edit_?"Done":"Edit"))])],1)])},staticRenderFns:[]}},984:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"card"},[i("div",{staticClass:"card-header"},[e._v("\n        Request Items\n    ")]),e._v(" "),i("div",{staticClass:"card-body"},[i("div",[i("el-form",{ref:"form",attrs:{"label-position":e.labelPosition,size:"mini",model:e.form},nativeOn:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-lg-12"},[i("div",{staticClass:"form-group"},[e.isAddDivision?i("div",[i("div",{staticClass:"input-group input-group-sm"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.division_name,expression:"division_name"}],staticClass:"form-control",attrs:{placeholder:"Division Name",type:"text"},domProps:{value:e.division_name},on:{input:function(t){t.target.composing||(e.division_name=t.target.value)}}}),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.division_supply,expression:"division_supply"}],staticClass:"form-control",attrs:{placeholder:"Supply Division Name",type:"text"},domProps:{value:e.division_supply},on:{input:function(t){t.target.composing||(e.division_supply=t.target.value)}}}),e._v(" "),i("span",{staticClass:"input-group-append"},[i("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:e.addDivision}},[e._v("Create Division")]),e._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(t){e.isAddDivision=!1}}},[e._v("Cancel")])])])]):i("div",[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm"},[i("label",{staticClass:"el-form-item__label",attrs:{for:"division"}},[e._v("Division")])]),e._v(" "),i("div",{staticClass:"col-sm text-right"},[e.isAddDivision?e._e():i("button",{staticClass:"btn btn-sm btn-link",attrs:{type:"button"},on:{click:function(t){e.isAddDivision=!e.isAddDivision}}},[e._v("Add Division\n                                        ")])])]),e._v(" "),i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.selectDivision,remote:"",clearable:"",filterable:"",placeholder:"Please enter a keyword","remote-method":e.searchDivision,"default-first-option":"",loading:e.loadingDivision},model:{value:e.form.division,callback:function(t){e.$set(e.form,"division",t)},expression:"form.division"}},e._l(e.optionDivision,function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)])]),e._v(" "),i("div",{staticClass:"col-sm-12"},[i("h3",[e._v("Add Items")]),e._v(" "),i("table",{staticClass:"table table-bordered"},[i("thead",[i("tr",[i("th",[e._v("Product Name")]),e._v(" "),i("th",[e._v("Current Stock")]),e._v(" "),i("th",[e._v("Quantity")]),e._v(" "),i("th",[e._v("Action")])])]),e._v(" "),i("tbody",[i("tr",[i("td",[i("el-select",{attrs:{disabled:e.select,remote:"",clearable:"",filterable:"",placeholder:"Please enter a keyword","remote-method":e.search_,loading:e.loading},on:{change:e.onChange},model:{value:e.addTable.name,callback:function(t){e.$set(e.addTable,"name",t)},expression:"addTable.name"}},e._l(e.options,function(e,t){return i("el-option",{key:t,attrs:{"value-key":e.value.id,label:e.label,value:e.value}})}))],1),e._v(" "),i("td",[i("el-input",{attrs:{disabled:!0,type:"number",min:"0",max:"addTable.quantity",placeholder:"Current Quantity"},model:{value:e.addTable.quantity,callback:function(t){e.$set(e.addTable,"quantity",t)},expression:"addTable.quantity"}})],1),e._v(" "),i("td",[i("el-input-number",{attrs:{min:0,max:e.cloneQuantity},on:{change:e.onChangeOutQuantity},model:{value:e.addTable.out_quantity,callback:function(t){e.$set(e.addTable,"out_quantity",t)},expression:"addTable.out_quantity"}})],1),e._v(" "),i("td",[i("el-button",{attrs:{type:"primary",disabled:0===e.addTable.out_quantity},on:{click:e.addColumn}},[e._v("Add\n                                    ")])],1)]),e._v(" "),e._l(e.form.supplies,function(e,t){return i("edit-supplies",{key:t,attrs:{max:e.cloneQuantity,item:e}})})],2)])])]),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",disabled:!(e.form.supplies.length&&e.form.division),loading:e.isDisabled},on:{click:e.onSubmitRequest}},[e._v("Approved\n                    ")]),e._v(" "),i("el-button",{attrs:{type:"danger",disabled:!(e.form.supplies.length&&e.form.division),loading:e.isDisabled},on:{click:e.onSubmitRejectRequest}},[e._v("Rejected\n                    ")]),e._v(" "),i("el-button",{attrs:{loading:e.isDisabled},on:{click:function(t){e.$router.push({name:"pending-request.view"})}}},[e._v("Back\n                    ")])],1)],1)],1)])])},staticRenderFns:[]}}});