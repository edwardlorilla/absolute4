webpackJsonp([19],{1000:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"form",attrs:{"label-position":t.labelPosition,size:"mini",model:t.form},nativeOn:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header"},[t._v("\n                Medicine Information\n            ")]),t._v(" "),a("div",{staticClass:"card-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("strong",[t._v("Generic Name:")]),t._v(" "+t._s(t.product.medicine_id?t.product.medicine.name.toUpperCase():"")+"\n                ")])])]),t._v(" "),a("div",{staticClass:"card-body"},[a("table",{staticClass:"table table-bordered"},[a("thead",[a("tr",[a("th",[t._v("Product Name")]),t._v(" "),a("th",[t._v("Category Name")]),t._v(" "),a("th",[t._v("Current Stock")]),t._v(" "),a("th",[t._v("Quantity")]),t._v(" "),a("th",[t._v("Action")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.select,remote:"","value-key":"id",clearable:"",filterable:"",placeholder:"Please enter a keyword","remote-method":t.search_,loading:t.loading},on:{change:t.onChange},model:{value:t.addTable.name,callback:function(e){t.$set(t.addTable,"name",e)},expression:"addTable.name"}},t._l(t.options,function(e,i){return a("el-option",{key:i,staticStyle:{padding:"0px"},attrs:{label:e.label,value:e.value}},[a("div",{on:{mouseover:function(a){t.onChangeProduct(e)},mouseleave:t.onChangeProductOut}},[a("span",{staticStyle:{padding:"0 20px"}},[t._v(t._s(""+e.label))])])])}))],1),t._v(" "),a("td",[a("el-input",{attrs:{type:"text",placeholder:"Category Name"},model:{value:t.addTable.category_id,callback:function(e){t.$set(t.addTable,"category_id",e)},expression:"addTable.category_id"}})],1),t._v(" "),a("td",[a("el-input",{attrs:{disabled:!0,type:"number",min:"0",max:"addTable.quantity",placeholder:"Current Quantity"},model:{value:t.addTable.quantity,callback:function(e){t.$set(t.addTable,"quantity",e)},expression:"addTable.quantity"}})],1),t._v(" "),a("td",[a("el-input-number",{attrs:{min:0,max:t.cloneQuantity},on:{change:t.onChangeOutQuantity},model:{value:t.addTable.out_quantity,callback:function(e){t.$set(t.addTable,"out_quantity",e)},expression:"addTable.out_quantity"}})],1),t._v(" "),a("td",[a("el-button",{attrs:{type:"primary",disabled:0===t.addTable.out_quantity},on:{click:t.addColumn}},[t._v("Add\n                       ")])],1)]),t._v(" "),t._l(t.form.products,function(t,e){return a("edit-product",{key:e,attrs:{max:t.cloneQuantity,item:t}})})],2)])])])]),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:!t.form.products.length,loading:t.isDisabled},on:{click:t.onSubmitRequest}},[t._v("Submit\n        ")]),t._v(" "),a("el-button",{attrs:{loading:t.isDisabled},on:{click:function(e){t.$router.push("/"+t.$route.meta.url)}}},[t._v("Back")])],1)],1)},staticRenderFns:[]}},799:function(t,e,a){var i=a(36)(a(998),a(1e3),!1,null,null,null);t.exports=i.exports},834:function(t,e,a){var i=a(36)(a(835),a(836),!1,null,null,null);t.exports=i.exports},835:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["item","max"],data:function(){return{edit_:!1}},methods:{onChangeOutQuantity:function(t,e){t>e?this.item.quantity-=t-e:this.item.quantity+=e-t},onEdit:function(){this.edit_=!this.edit_}}}},836:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t.edit_?a("el-input",{attrs:{placeholder:"Product Name"},model:{value:t.item.name,callback:function(e){t.$set(t.item,"name",e)},expression:"item.name"}}):a("label",[t._v(t._s(t.item.name))])],1),t._v(" "),a("td",[t.edit_?a("el-input",{attrs:{placeholder:"Category Name"},model:{value:t.item.category_id,callback:function(e){t.$set(t.item,"category_id",e)},expression:"item.category_id"}}):a("label",[t._v(t._s(t.item.category_id))])],1),t._v(" "),a("td",[t.edit_?a("el-input",{attrs:{disabled:!0,type:"number",min:"0",max:"addTable.quantity",placeholder:"Current Quantity"},model:{value:t.item.quantity,callback:function(e){t.$set(t.item,"quantity",e)},expression:"item.quantity"}}):a("label",[t._v(t._s(t.item.quantity))])],1),t._v(" "),a("td",[t.edit_?a("el-input-number",{attrs:{min:0,max:t.max},on:{change:t.onChangeOutQuantity},model:{value:t.item.out_quantity,callback:function(e){t.$set(t.item,"out_quantity",e)},expression:"item.out_quantity"}}):a("label",[t._v(t._s(t.item.out_quantity))])],1),t._v(" "),a("td",[a("el-button",{attrs:{type:"primary"},on:{click:t.onEdit}},[t._v(t._s(t.edit_?"Done":"Edit"))])],1)])},staticRenderFns:[]}},998:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(a(999)),n=o(a(834));function o(t){return t&&t.__esModule?t:{default:t}}e.default={beforeCreate:function(){axios.get("/api/products/mass-update")},components:{EditProduct:n.default},mixins:[i.default],data:function(){return{product:{},option:{penColor:"rgb(0, 0, 0)",backgroundColor:"rgb(255,255,255)"},request_id:1,dialogVisible:!1,optionDivision:[],loadingDivision:!1,selectDivision:!1,isAddDivision:!1,division_name:"",division_supply:"",select:!1,cloneQuantity:0,addTable:{id:"",name:"",category_id:"",quantity:"",out_quantity:""},columns:[{id:"name",label:"Transactions Name"},{id:"category_id",label:"Category Name"},{id:"quantity",label:"Current Stock"},{id:"out_quantity",label:"Quantity"}],form:{products:[],division:"",request_date:"",request_year_code:""},loading:!1,options:[]}},mounted:function(){},methods:{addDivision:function(){var t=this;t.isDisabled=!0,axios.post("/api/divisions",{name:t.division_name,supply_division:t.division_supply,station:""}).then(function(e){t.$message({message:e.statusText,type:"success"}),t.isAddDivision=!1,t.isDisabled=!1,t.optionDivision.push({value:e.data.id,label:e.data.name}),t.form.division=e.data.id}).catch(function(e){e.response.data.errors&&e.response.data.message&&(t.$message({message:e.response.data.message,type:"error"}),t.isAddDivision=!1),t.isDisabled=!1})},onSubmitRequest:function(){var t=this,e=new Date,a=e.getFullYear(),i=e.getMonth()+1,n=e.getDate();t.isDisabled=!0,t.errors=[],t.form.year=a,t.form.request_date=i+"/"+n+"/"+a,t.form.request_year_code=a,axios({method:t.$route.params.id?"PUT":"POST",url:"/api/"+(t.$route.params.id?t.$route.meta.url+"/"+t.$route.params.id:""+t.$route.meta.url),data:t.form}).then(function(e){t.$message({message:"Your request currently under review.",type:"success"}),t.isDisabled=!1,t.form={products:[],division:"",name:"",year:"",request_date:"",request_year_code:""},t.dialogVisible=!0,t.request_id=e.data.id,t.$root.store.dispatch("loadNotification")}).catch(function(e){e.response.data.errors&&e.response.data.message&&(t.errors=e.response.data.errors,t.$message({message:e.response.data.message,type:"error"})),t.isDisabled=!1,t.errors.division&&t.$confirm("No division assigned, please contact your administrator","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"})})},onChangeOutQuantity:function(t,e){var a=_.isInteger(t)?t:0,i=_.isInteger(e)?e:0;_.isInteger(a)&&_.isInteger(i)?a>i?this.addTable.quantity-=a-i:this.addTable.quantity+=i-a:this.addTable.quantity=this.cloneQuantity},onChangeProduct:function(t){this.product=t.value},onChangeProductOut:function(){this.addTable.name||(this.product={})},onChange:function(t){var e=this;e.select=!0,t?(e.addTable={id:t.id,name:t.medicine.name,category_id:t.category?t.category.name:"",package_id:t.package?t.package.name:"",quantity:t.quantity,out_quantity:0},e.cloneQuantity=t.quantity,e.select=!1):(e.addTable={id:"",name:"",category_id:"",quantity:"",out_quantity:""},e.cloneQuantity=0,e.select=!1)},addColumn:function(){var t="Please input the",e=this;e.addTable.id&&e.addTable.name&&e.addTable.category_id&&e.addTable.out_quantity?axios.get("/api/products/disabled/"+e.addTable.id).then(function(t){e.form.products.unshift(_.clone(e.addTable)),e.options=[],e.addTable={id:"",name:"",category_id:"",quantity:"",out_quantity:""}}):(e.addTable.id&&(t+=" ID |"),e.addTable.name&&(t+=" Name |"),e.addTable.category_id&&(t+=" Category |"),e.$message({message:t,type:"warning"}))},onSearchDivision:_.debounce(function(t,e){axios.get("/api/search/divisions?search="+t).then(function(t){e.loadingDivision=!1,e.optionDivision=t.data.map(function(t){return{value:t.id,label:t.name}})}).catch(function(){e.loadingDivision=!1})},350),onSearch:_.debounce(function(t,e){e.loading=!0,axios.get("/api/search/request-medicine?search="+t).then(function(t){e.loading=!1,e.options=_.map(t.data,function(t){return{value:t,label:t.medicine.name}})}).catch(function(){e.loading=!1})},350),searchDivision:function(t){var e=this;""!==t?(e.loadingDivision=!0,e.onSearchDivision(t,e)):(e.loadingDivision=!1,e.optionDivision=[])},search_:function(t){var e=this;""!==t?(e.loading=!0,e.onSearch(t,e)):(e.loading=!1,e.option=[])}}}},999:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{isDisabled:!1,labelPosition:"left",errors:[]}},beforeRouteEnter:function(t,e,a){t.params.id?axios.get("/api/"+t.meta.url+"/"+t.params.id).then(function(t){a(function(e){return e.setData(t.data)})}):a()},beforeRouteUpdate:function(t,e,a){var i=this;t.params.id?axios.get("/api/"+t.meta.url+"/"+t.params.id).then(function(t){i.setData(t.data),a()}):a()},methods:{setData:function(t){var e=this;e.optionCustomer.push({value:t.customer.id,label:t.customer.name}),e.optionDoctor.push({value:t.doctor.id,label:t.doctor.name}),e.form={id:t.id,request_date:t.request_date,request_year_code:t.request_year_code,remark:t.remark,doctor:t.doctor.id,customer:t.customer.id,products:[]},_.map(t.transactions,function(t){var a=t.product;return axios.get("/api/products/disabled/"+a.id),e.form.products.unshift({id:a.id,transaction_id:t.id,name:a.name,category_id:a.category.name,package_id:a.package.name,quantity:a.quantity,cloneQuantity:a.quantity,out_quantity:t.out_quantity})})}}}}});