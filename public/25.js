webpackJsonp([25],{794:function(e,t,a){var i=a(36)(a(978),a(979),!1,null,null,null);e.exports=i.exports},834:function(e,t,a){var i=a(36)(a(835),a(836),!1,null,null,null);e.exports=i.exports},835:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["item","max"],data:function(){return{edit_:!1}},methods:{onChangeOutQuantity:function(e,t){e>t?this.item.quantity-=e-t:this.item.quantity+=t-e},onEdit:function(){this.edit_=!this.edit_}}}},836:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",[a("td",[e.edit_?a("el-input",{attrs:{placeholder:"Product Name"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}}):a("label",[e._v(e._s(e.item.name))])],1),e._v(" "),a("td",[e.edit_?a("el-input",{attrs:{placeholder:"Category Name"},model:{value:e.item.category_id,callback:function(t){e.$set(e.item,"category_id",t)},expression:"item.category_id"}}):a("label",[e._v(e._s(e.item.category_id))])],1),e._v(" "),a("td",[e.edit_?a("el-input",{attrs:{disabled:!0,type:"number",min:"0",max:"addTable.quantity",placeholder:"Current Quantity"},model:{value:e.item.quantity,callback:function(t){e.$set(e.item,"quantity",t)},expression:"item.quantity"}}):a("label",[e._v(e._s(e.item.quantity))])],1),e._v(" "),a("td",[e.edit_?a("el-input-number",{attrs:{min:0,max:e.max},on:{change:e.onChangeOutQuantity},model:{value:e.item.out_quantity,callback:function(t){e.$set(e.item,"out_quantity",t)},expression:"item.out_quantity"}}):a("label",[e._v(e._s(e.item.out_quantity))])],1),e._v(" "),a("td",[a("el-button",{attrs:{type:"primary"},on:{click:e.onEdit}},[e._v(e._s(e.edit_?"Done":"Edit"))])],1)])},staticRenderFns:[]}},978:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n=a(834),s=(i=n)&&i.__esModule?i:{default:i};t.default={beforeCreate:function(){axios.get("/api/products/mass-update")},components:{EditProduct:s.default},data:function(){return{isDisabled:!1,labelPosition:"left",errors:[],option:{penColor:"rgb(0, 0, 0)",backgroundColor:"rgb(255,255,255)"},request_id:1,dialogVisible:!1,optionDivision:[],loadingDivision:!1,selectDivision:!1,isAddDivision:!1,isAddSupplier:!1,selectSupplier:!1,optionSupplier:[],loadingSupplier:!1,division_name:"",division_supply:"",select:!1,cloneQuantity:0,addTable:{id:"",name:"",category_id:"",package_id:"",quantity:"",out_quantity:""},columns:[{id:"name",label:"Transactions Name"},{id:"category_id",label:"Category Name"},{id:"package_id",label:"Unit"},{id:"quantity",label:"Current Stock"},{id:"out_quantity",label:"Quantity"}],form:{products:[],supplier:"",division:"",request_date:"",request_year_code:"",user_id:null},supplier:"",supplier_name:"",supplier_address:"",loading:!1,options:[]}},beforeRouteEnter:function(e,t,a){e.params.id?axios.get("/api/"+e.meta.url+"/"+e.params.id).then(function(e){a(function(t){return t.setData(e.data)})}):a()},beforeRouteUpdate:function(e,t,a){var i=this;e.params.id?axios.get("/api/"+e.meta.url+"/"+e.params.id).then(function(e){i.setData(e.data),a()}):a()},methods:{setData:function(e){var t=this;t.form.products=[],t.form.user_id=e.data.user_id,t.$root.store.dispatch("loadingChange",!0),axios.get("/api/division/"+e.data.data.division).then(function(a){t.optionDivision.push({label:a.data.name,value:a.data.id}),t.form.division=e.data.data.division}),_.map(e.data.data.products,function(a){axios.get("/api/product/"+a.id).then(function(i){if(t.form.products.push({id:i.data.id,name:a.name,category_id:a.category_id,package_id:a.package_id,quantity:i.data.quantity,out_quantity:i.data.quantity<a.out_quantity?i.data.quantity:a.out_quantity}),e.data.data.products.length)return""}).then(function(e){t.$root.store.dispatch("loadingChange",!1)})})},addSupplier:function(){var e=this;e.isDisabled=!0,axios.post("/api/suppliers",{name:e.supplier_name,address:e.supplier_address}).then(function(t){e.$message({message:t.statusText,type:"success"}),e.isAddSupplier=!1,e.isDisabled=!1,e.optionSupplier.push({value:t.data.id,label:t.data.name}),e.form.supplier=t.data.id}).catch(function(t){t.response.data.errors&&t.response.data.message&&(e.$message({message:t.response.data.message,type:"error"}),e.isAddSupplier=!1),e.isDisabled=!1})},addDivision:function(){var e=this;e.isDisabled=!0,axios.post("/api/divisions",{name:e.division_name,supply_division:e.division_supply,station:""}).then(function(t){e.$message({message:t.statusText,type:"success"}),e.isAddDivision=!1,e.isDisabled=!1,e.optionDivision.push({value:t.data.id,label:t.data.name}),e.form.division=t.data.id}).catch(function(t){t.response.data.errors&&t.response.data.message&&(e.$message({message:t.response.data.message,type:"error"}),e.isAddDivision=!1),e.isDisabled=!1})},onSubmitRequest:function(){var e=this,t=new Date,a=t.getFullYear(),i=t.getMonth()+1,n=t.getDate();e.isDisabled=!0,e.errors=[],e.form.year=a,e.form.request_date=i+"/"+n+"/"+a,e.form.request_year_code=a,axios({method:"POST",url:"/api/pending/request-medicine/approved/"+e.$route.params.id,data:e.form}).then(function(t){e.$message({message:t.statusText,type:"success"}),e.isDisabled=!1,e.form={products:[],name:"",year:"",request_date:"",request_year_code:""},e.dialogVisible=!0,e.request_id=t.data.id;var a=e.$root.store.state.notifications.data,i=_.findIndex(a,["id",e.$route.params.id]);-1!=i&&a.splice(i,1),e.$router.push({name:"pending-request.view"})}).catch(function(t){t.response.data.errors&&t.response.data.message&&(e.errors=t.response.data.errors,e.$message({message:t.response.data.message,type:"error"})),e.isDisabled=!1})},onChangeOutQuantity:function(e,t){e>t?this.addTable.quantity-=e-t:this.addTable.quantity+=t-e},onChange:function(e){var t=this;t.select=!0,e?(t.addTable={id:e.id,name:e.medicine.name,category_id:e.category.name,package_id:e.package.name,quantity:e.quantity,out_quantity:0},t.cloneQuantity=e.quantity,t.select=!1):(t.addTable={id:"",name:"",category_id:"",package_id:"",quantity:"",out_quantity:""},t.cloneQuantity=0,t.select=!1)},addColumn:function(){var e="Please input the",t=this;t.addTable.id&&t.addTable.name&&t.addTable.category_id&&t.addTable.package_id&&t.addTable.out_quantity?axios.get("/api/products/disabled/"+t.addTable.id).then(function(e){t.form.products.unshift(_.clone(t.addTable)),t.options=[],t.addTable={id:"",name:"",category_id:"",package_id:"",quantity:"",out_quantity:""}}):(t.addTable.id&&(e+=" ID |"),t.addTable.name&&(e+=" Name |"),t.addTable.category_id&&(e+=" Category |"),t.addTable.package_id&&(e+=" Package |"),t.$message({message:e,type:"warning"}))},onSearchSupplier:_.debounce(function(e,t){axios.get("/api/search/suppliers?search="+e).then(function(e){t.loadingSupplier=!1,t.optionSupplier=e.data.map(function(e){return{value:e.id,label:e.name}})}).catch(function(){t.loadingSupplier=!1})},350),onSearch:_.debounce(function(e,t){t.loading=!0,axios.get("/api/search/request-medicine?search="+e).then(function(e){t.loading=!1,t.options=e.data.map(function(e){return{value:e,label:e.medicine.name}})}).catch(function(){t.loading=!1})},350),searchDivision:function(e){var t=this;""!==e?(t.loadingDivision=!0,t.onSearchDivision(e,t)):(t.loadingDivision=!1,t.optionDivision=[])},searchSupplier:function(e){var t=this;""!==e?(t.loadingSupplier=!0,t.onSearchSupplier(e,t)):(t.loadingSupplier=!1,t.optionSupplier=[])},search_:function(e){var t=this;""!==e?(t.loading=!0,t.onSearch(e,t)):(t.loading=!1,t.option=[])}}}},979:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{"label-position":e.labelPosition,size:"mini",model:e.form},nativeOn:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-12"},[a("div",{staticClass:"form-group"},[e.isAddDivision?a("div",[a("div",{staticClass:"input-group input-group-sm"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.division_name,expression:"division_name"}],staticClass:"form-control",attrs:{placeholder:"Division Name",type:"text"},domProps:{value:e.division_name},on:{input:function(t){t.target.composing||(e.division_name=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.division_supply,expression:"division_supply"}],staticClass:"form-control",attrs:{placeholder:"Supply Division Name",type:"text"},domProps:{value:e.division_supply},on:{input:function(t){t.target.composing||(e.division_supply=t.target.value)}}}),e._v(" "),a("span",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:e.addDivision}},[e._v("Create Division")]),e._v(" "),a("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(t){e.isAddDivision=!1}}},[e._v("Cancel")])])])]):a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm"},[a("label",{staticClass:"el-form-item__label",attrs:{for:"division"}},[e._v("Division")])]),e._v(" "),a("div",{staticClass:"col-sm text-right"},[e.isAddDivision?e._e():a("button",{staticClass:"btn btn-sm btn-link",attrs:{type:"button"},on:{click:function(t){e.isAddDivision=!e.isAddDivision}}},[e._v("Add Division\n                                ")])])]),e._v(" "),a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.selectDivision,remote:"",clearable:"",filterable:"",placeholder:"Please enter a keyword","remote-method":e.searchDivision,"default-first-option":"",loading:e.loadingDivision},model:{value:e.form.division,callback:function(t){e.$set(e.form,"division",t)},expression:"form.division"}},e._l(e.optionDivision,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1)])]),e._v(" "),a("div",{staticClass:"col-sm-12"},[a("h3",[e._v("Add Items")]),e._v(" "),a("table",{staticClass:"table table-bordered"},[a("thead",[a("tr",[a("th",[e._v("Product Name")]),e._v(" "),a("th",[e._v("Category Name")]),e._v(" "),a("th",[e._v("Current Stock")]),e._v(" "),a("th",[e._v("Quantity")]),e._v(" "),a("th",[e._v("Action")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("el-select",{attrs:{disabled:e.select,remote:"","value-key":"id",clearable:"",filterable:"",placeholder:"Please enter a keyword","remote-method":e.search_,loading:e.loading},on:{change:e.onChange},model:{value:e.addTable.name,callback:function(t){e.$set(e.addTable,"name",t)},expression:"addTable.name"}},e._l(e.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("td",[a("el-input",{attrs:{type:"text",placeholder:"Category Name"},model:{value:e.addTable.category_id,callback:function(t){e.$set(e.addTable,"category_id",t)},expression:"addTable.category_id"}})],1),e._v(" "),a("td",[a("el-input",{attrs:{disabled:!0,type:"number",min:"0",max:"addTable.quantity",placeholder:"Current Quantity"},model:{value:e.addTable.quantity,callback:function(t){e.$set(e.addTable,"quantity",t)},expression:"addTable.quantity"}})],1),e._v(" "),a("td",[a("el-input-number",{attrs:{min:0,max:e.cloneQuantity},on:{change:e.onChangeOutQuantity},model:{value:e.addTable.out_quantity,callback:function(t){e.$set(e.addTable,"out_quantity",t)},expression:"addTable.out_quantity"}})],1),e._v(" "),a("td",[a("el-button",{attrs:{type:"primary",disabled:0===e.addTable.out_quantity},on:{click:e.addColumn}},[e._v("Add\n                            ")])],1)]),e._v(" "),e._l(e.form.products,function(e,t){return a("edit-product",{key:t,attrs:{max:e.cloneQuantity,item:e}})})],2)])])]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:!(e.form.products.length&&e.form.division),loading:e.isDisabled},on:{click:e.onSubmitRequest}},[e._v("Approved\n            ")]),e._v(" "),a("el-button",{attrs:{loading:e.isDisabled},on:{click:function(t){e.$router.push({name:"pending-request.view"})}}},[e._v("Back\n            ")])],1)],1)],1)},staticRenderFns:[]}}});